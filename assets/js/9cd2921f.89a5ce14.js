(self.webpackChunkstryker_mutator_github_io=self.webpackChunkstryker_mutator_github_io||[]).push([[4365],{3905:function(e,t,r){"use strict";r.d(t,{Zo:function(){return p},kt:function(){return m}});var n=r(7294);function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function s(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){o(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function a(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}var u=n.createContext({}),l=function(e){var t=n.useContext(u),r=t;return e&&(r="function"==typeof e?e(t):s(s({},t),e)),r},p=function(e){var t=l(e.components);return n.createElement(u.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},d=n.forwardRef((function(e,t){var r=e.components,o=e.mdxType,i=e.originalType,u=e.parentName,p=a(e,["components","mdxType","originalType","parentName"]),d=l(r),m=o,h=d["".concat(u,".").concat(m)]||d[m]||c[m]||i;return r?n.createElement(h,s(s({ref:t},p),{},{components:r})):n.createElement(h,s({ref:t},p))}));function m(e,t){var r=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var i=r.length,s=new Array(i);s[0]=d;var a={};for(var u in t)hasOwnProperty.call(t,u)&&(a[u]=t[u]);a.originalType=e,a.mdxType="string"==typeof e?e:o,s[1]=a;for(var l=2;l<i;l++)s[l]=r[l];return n.createElement.apply(null,s)}return n.createElement.apply(null,r)}d.displayName="MDXCreateElement"},3950:function(e,t,r){"use strict";r.r(t),r.d(t,{frontMatter:function(){return i},metadata:function(){return s},toc:function(){return a},default:function(){return l}});var n=r(2122),o=(r(7294),r(3905));const i={title:"Troubleshooting",custom_edit_url:"https://github.com/stryker-mutator/stryker-js/edit/master/docs/troubleshooting.md"},s={unversionedId:"stryker-js/troubleshooting",id:"stryker-js/troubleshooting",isDocsHomePage:!1,title:"Troubleshooting",description:"Below you'll find an ever-growing list of issues that you might occur when running StrykerJS on your project for the first time.",source:"@site/docs/stryker-js/troubleshooting.md",sourceDirName:"stryker-js",slug:"/stryker-js/troubleshooting",permalink:"/docs/stryker-js/troubleshooting",editUrl:"https://github.com/stryker-mutator/stryker-js/edit/master/docs/troubleshooting.md",version:"current",frontMatter:{title:"Troubleshooting",custom_edit_url:"https://github.com/stryker-mutator/stryker-js/edit/master/docs/troubleshooting.md"},sidebar:"docs",previous:{title:"TypeScript Checker",permalink:"/docs/stryker-js/typescript-checker"},next:{title:"Angular",permalink:"/docs/stryker-js/guides/angular"}},a=[{value:"Build command fails",id:"build-command-fails",children:[]},{value:"Initial test run fails",id:"initial-test-run-fails",children:[]},{value:"No tests executed - Jest runner",id:"no-tests-executed---jest-runner",children:[]},{value:"All mutants survive - Jest runner",id:"all-mutants-survive---jest-runner",children:[]},{value:"Jest crashes with a multi project configuration",id:"jest-crashes-with-a-multi-project-configuration",children:[]}],u={toc:a};function l({components:e,...t}){return(0,o.kt)("wrapper",(0,n.Z)({},u,t,{components:e,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"Below you'll find an ever-growing list of issues that you might occur when running StrykerJS on your project for the first time."),(0,o.kt)("h3",{id:"build-command-fails"},"Build command fails"),(0,o.kt)("p",null,"Example:"),(0,o.kt)("blockquote",null,(0,o.kt)("pre",{parentName:"blockquote"},(0,o.kt)("code",{parentName:"pre"}," ERROR Stryker Unexpected error occurred while running Stryker Error: Command failed with exit code 1:\n my-build-command\n"))),(0,o.kt)("p",null,"If you're running into issues with your ",(0,o.kt)("inlineCode",{parentName:"p"},"buildCommand"),", try to execute it by hand to make sure it works. For example, if your ",(0,o.kt)("inlineCode",{parentName:"p"},"buildCommand")," is ",(0,o.kt)("inlineCode",{parentName:"p"},'"tsc -b path/to/tsconfig.json"'),", try to run ",(0,o.kt)("inlineCode",{parentName:"p"},"npx tsc  -b path/to/tsconfig.json")," yourself, did it have the desired effect?"),(0,o.kt)("p",null,"If that works, the next step would be to try the command yourself ",(0,o.kt)("em",{parentName:"p"},"inside the Stryker sandbox directory"),". Please ",(0,o.kt)("inlineCode",{parentName:"p"},"cd")," into the ",(0,o.kt)("inlineCode",{parentName:"p"},".stryker-tmp/sandbox-xxxxx")," directory and try the command there. For example:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-shell"},"cd .stryker-tmp/sandbox-12345678\nnode ../../node_modules/typescript/bin/tsc -b path/to/tsconfig.json\n")),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Note"),": since the sandbox dir doesn't have you node_modules, you will need to specify the full path to the TypeScript compiler."),(0,o.kt)("h3",{id:"initial-test-run-fails"},"Initial test run fails"),(0,o.kt)("p",null,"Example:"),(0,o.kt)("blockquote",null,(0,o.kt)("pre",{parentName:"blockquote"},(0,o.kt)("code",{parentName:"pre"},"One or more tests resulted in an error\n[...] Cannot assign to 'stryNS_9fa48' because it is not a variable [...]\n"))),(0,o.kt)("p",null,"The initial test run might fail when you're using ts-jest or ts-node. The reason for this is that Stryker will mutate your code and, by doing so, introduce type errors into your code. Stryker tries to ignore these errors by adding ",(0,o.kt)("a",{parentName:"p",href:"https://devblogs.microsoft.com/typescript/announcing-typescript-3-7/#ts-nocheck-in-typescript-files"},(0,o.kt)("inlineCode",{parentName:"a"},"// @ts-nocheck"))," in your source files. However, this is only done for TypeScript-like files inside your ",(0,o.kt)("inlineCode",{parentName:"p"},"lib"),", ",(0,o.kt)("inlineCode",{parentName:"p"},"src"),", and ",(0,o.kt)("inlineCode",{parentName:"p"},"test")," directories by default. If you have your code somewhere else, you will need to override ",(0,o.kt)("a",{parentName:"p",href:"/docs/stryker-js/configuration#disabletypechecks-false--string"},"disableTypeChecks")," yourself:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "disableTypeChecks": "app/**/*.{js,ts,jsx,tsx,html,vue}"\n}\n')),(0,o.kt)("p",null,"Another cause might be that you're using TypeScript v3.7 or lower. In that case, you should update TypeScript to at least v3.7 or higher. Alternatively you can try to switch to another transpiler, like ",(0,o.kt)("a",{parentName:"p",href:"https://babeljs.io/docs/en/babel-preset-typescript"},"babel"),", but, honestly, updating TypeScript should be the first solution."),(0,o.kt)("h3",{id:"no-tests-executed---jest-runner"},"No tests executed - Jest runner"),(0,o.kt)("p",null,"You might run into issues like this when using the ",(0,o.kt)("inlineCode",{parentName:"p"},"@stryker-mutator/jest-runner"),":"),(0,o.kt)("blockquote",null,(0,o.kt)("pre",{parentName:"blockquote"},(0,o.kt)("code",{parentName:"pre"},"No tests found, exiting with code 1\nRun with `--passWithNoTests` to exit with code 0\n"))),(0,o.kt)("p",null,"You will need to override the ",(0,o.kt)("inlineCode",{parentName:"p"},"tempDirName")," to a directory without a ",(0,o.kt)("inlineCode",{parentName:"p"},".")," in front of it."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},'{\n   "tempDirName": "stryker-tmp"\n}\n')),(0,o.kt)("p",null,"See ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/stryker-mutator/stryker-js/issues/1691"},"#1691")," for more info."),(0,o.kt)("h3",{id:"all-mutants-survive---jest-runner"},"All mutants survive - Jest runner"),(0,o.kt)("p",null,"When running with the ",(0,o.kt)("inlineCode",{parentName:"p"},"@stryker-mutator/jest-runner")," on windows you might run into the issue where all mutants survive unexpectedly:"),(0,o.kt)("blockquote",null,(0,o.kt)("pre",{parentName:"blockquote"},(0,o.kt)("code",{parentName:"pre"},"[...]\n#3. [Survived] ArithmeticOperator\nC:\\z\\github\\stryker-mutator\\stryker-js\\e2e\\test\\jest-node\\src\\sum.js:5:10\n-     return a - b;\n+     return a + b;\nRan all tests for this mutant.\n\nRan 0.00 tests per mutant on average.\n----------|---------|----------|-----------|------------|----------|---------|\nFile      | % score | # killed | # timeout | # survived | # no cov | # error |\n----------|---------|----------|-----------|------------|----------|---------|\nAll files |    0.00 |        0 |         0 |          4 |        0 |       0 |\n sum.js   |    0.00 |        0 |         0 |          4 |        0 |       0 |\n----------|---------|----------|-----------|------------|----------|---------|\n"))),(0,o.kt)("p",null,"The root cause for this is that Jest doesn't support running in a hidden directory on windows, like StrykerJS does by default (the sandbox directory is located in ",(0,o.kt)("inlineCode",{parentName:"p"},".stryker-tmp"),", a hidden directory). See ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/facebook/jest/issues/9728"},"issue 9728")," for more info."),(0,o.kt)("p",null,"Known workarounds:"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Change the ",(0,o.kt)("a",{parentName:"li",href:"/docs/stryker-js/configuration#tempdirname-string"},(0,o.kt)("inlineCode",{parentName:"a"},"tempDirName"))," to a non-hidden directory, for example ",(0,o.kt)("inlineCode",{parentName:"li"},"--tempDirName stryker-tmp"),"."),(0,o.kt)("li",{parentName:"ol"},"You can also choose to run Stryker in place, using ",(0,o.kt)("a",{parentName:"li",href:"/docs/stryker-js/configuration#inplace-boolean"},(0,o.kt)("inlineCode",{parentName:"a"},"--inPlace")))),(0,o.kt)("h3",{id:"jest-crashes-with-a-multi-project-configuration"},"Jest crashes with a multi project configuration"),(0,o.kt)("p",null,"Example:"),(0,o.kt)("blockquote",null,(0,o.kt)("pre",{parentName:"blockquote"},(0,o.kt)("code",{parentName:"pre"}," ERROR DryRunExecutor One or more tests resulted in an error:\n        Test runner crashed. Tried twice to restart it without any luck. Last time the error message was:\nError: Jest: Cannot use configuration as an object without a file path.\n    at readConfig (C:\\z\\github\\jest-issue\\node_modules\\jest-config\\build\\index.js:188:13)\n"))),(0,o.kt)("p",null,"This can happen when you have multiple ",(0,o.kt)("a",{parentName:"p",href:"https://jestjs.io/docs/configuration#projects-arraystring--projectconfig"},(0,o.kt)("inlineCode",{parentName:"a"},'"projects"'))," defined in your Jest configuration. Currently, the jest-runner uses the ",(0,o.kt)("inlineCode",{parentName:"p"},"runCli")," of Jest, which doesn't support this. However, ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/facebook/jest/pull/11307"},"the PR that adds support for this just merged"),", so future releases of Jest should work. "),(0,o.kt)("p",null,'Until then, the only known workaround is to configure Jest without using "projects" \ud83e\udd37\u200d\u2642\ufe0f.'))}l.isMDXComponent=!0}}]);